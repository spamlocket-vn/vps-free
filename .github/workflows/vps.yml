name: 10 VPS Free

on:
  workflow_dispatch:

jobs:
  vps:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        vps_id: [1,2,3,4,5,6,7,8,9,10]
    steps:
      - name: Update & Install tmate
        run: |
          sudo apt update
          sudo apt install -y tmate curl wget gnupg

      - name: CÃ i Node.js + npm
        run: |
          curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -
          sudo apt-get install -y nodejs
          node -v
          npm -v

      - name: CÃ i Google Chrome
        run: |
          wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
          sudo apt install -y ./google-chrome-stable_current_amd64.deb
          google-chrome --version

      - name: CÃ i thÆ° viá»‡n Node (global)
        run: |
          npm install -g \
            yarn \
            pm2 \
            puppeteer \
            puppeteer-extra \
            puppeteer-extra-plugin-stealth \
            puppeteer-real-browser \
            axios \
            express

      - name: Táº£i raw.js tá»« repo
        run: |
          wget -O raw.js "https://raw.githubusercontent.com/spamlocket-vn/vps-free/main/raw.js"
          ls -lh raw.js
          echo "ğŸ“‚ File raw.js Ä‘Ã£ Ä‘Æ°á»£c táº£i vá», báº¡n SSH vÃ o rá»“i cháº¡y: node raw.js"

      - name: Start tmate (VPS${{ matrix.vps_id }})
        run: |
          tmate -S /tmp/tmate.sock new-session -d
          tmate -S /tmp/tmate.sock wait tmate-ready
          echo "ğŸ”‘ VPS${{ matrix.vps_id }} SSH:"
          tmate -S /tmp/tmate.sock display -p '#{tmate_ssh}'
          echo "ğŸŒ VPS${{ matrix.vps_id }} Web:"
          tmate -S /tmp/tmate.sock display -p '#{tmate_web}'

      - name: Keep alive 1h
        run: |
          echo "âœ… VPS${{ matrix.vps_id }} Ä‘Ã£ sáºµn sÃ ng (cÃ³ sáºµn raw.js)."
          sleep 1h
